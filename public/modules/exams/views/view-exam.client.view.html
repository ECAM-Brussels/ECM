<section data-ng-controller="ExamsController" data-ng-init="findOne()">
	<h2>{{exam.course.ID}}</h2>

	<h3>{{'EXAMS.INFORMATION' | translate}}</h3>

	<div id="bla">
	</div>

	<dl class="dl-horizontal">
		<dt>{{'EXAMS.TITLE' | translate}}</dt>
		<dd>{{exam.title ? exam.title : '&mdash;'}}</dd>
		<dt>{{'EXAMS.COURSE' | translate}}</dt>
		<dd>{{exam.course.ID}} &mdash; {{exam.course.name}}</dd>
		<dt>{{'EXAMS.COORDINATOR' | translate}}</dt>
		<dd>{{exam.course.coordinator.username}}</dd>
		<dt>{{'EXAMS.EXAMSESSION' | translate}}</dt>
		<dd>{{exam.examsession.name}}</dd>
		<dt>{{'EXAMS.DATE' | translate}}</dt>
		<dd>{{exam.date | amDateFormat: 'dddd Do MMMM YYYY HH:mm'}}</dd>
		<dt>{{'EXAMS.DURATION' | translate}}</dt>
		<dd>{{exam.duration}} {{'EXAMS.MINUTES' | translate}}</dd>
	</dl>

	<tabset>
		<tab heading="Copies">
			<div>
				<p class="text-right"><button data-ng-click="addCopy()" class="btn btn-success"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> {{'EXAMS.ADD_COPY' | translate}}</button></p>
			</div>

			<div data-ng-if="! exam.copies || exam.copies.length === 0">
				{{'EXAMS.NO_COPIES' | translate}}
			</div>

			<div data-ng-if="exam.copies && exam.copies.length > 0">
				<ul class="list-group">
					<li class="list-group-item" data-ng-repeat="i in getNumber(exam.copies.length) track by $index">
						<p><b>{{'EXAMS.QUESTIONNAIRE' | translate}} {{getLetter($index)}}</b></p>
						<div data-ng-if="exam.copies[$index] && exam.copies[$index].name">
							<form method="post" action="/download/copy" target="_blank">
								<p>A file has been uploaded on {{exam.copies[$index].created | date: "dd MMM yyyy H:mm"}} (<input type="hidden" name="exam" data-ng-value="exam._id"><input type="hidden" name="index" data-ng-value="$index"><button type="submit" class="btn btn-link">{{'EXAMS.PREVIEW_COPY' | translate}}</button>)</p>
							</form>
						</div>
						<progressbar data-ng-if="progressValue[$index]" class="progress-striped active" animate="true" max="100" value="progressValue[$index]" type="success"><i>{{progressValue[$index]}} %</i></progressbar>
						<div data-ng-if="! exam.copies[$index].validated">
							<button data-ng-if="! uploading[$index]" class="btn btn-primary" ngf-select accept="application/pdf" ngf-allow-dir="false" data-ng-model="files" ngf-change="fileSelected($files, $event, $index)">{{'EXAMS.UPLOAD_COPY' | translate}}</button>
							<button data-ng-if="exam.copies[$index] && exam.copies[$index].name" data-ng-click="validate($index)" class="btn btn-success">{{'EXAMS.VALIDATE_COPY' | translate}}</button>
						</div>
					</li>
				</ul>
			</div>
		</tab>

		<tab heading="Registered students">
			<div data-ng-if="! exam.affectation || exam.affectation.length">
				<ul class="list-group">
					<li class="list-group-item" data-ng-repeat="i in getNumber(exam.affectation.length) track by $index"><b>#{{exam.affectation[$index].number}}</b> {{exam.affectation[$index].student.firstname}} {{exam.affectation[$index].student.lastname}} with seat #{{exam.affectation[$index].seat}} in room {{exam.affectation[$index].room.ID}}</li>
				</ul>
			</div>

			<div data-ng-if="exam.affectation && ! exam.affectation.length">{{'EXAMS.NO_REGISTERED_STUDENT' | translate}}</div>
		</tab>
		
		<tab heading="Rooms">
			<div data-ng-if="exam.rooms && ! exam.rooms.length">{{'EXAMS.NO_ROOM' | translate}}</div>
		</tab>
	</tabset>
</section>